<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Searching Metasploit" /><meta property="og:locale" content="en" /><meta name="description" content="I void warranties" /><meta property="og:description" content="I void warranties" /><link rel="canonical" href="http://theevilsaint.github.io/posts/searching-metasploit/" /><meta property="og:url" content="http://theevilsaint.github.io/posts/searching-metasploit/" /><meta property="og:site_name" content="EvilSaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-11T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Searching Metasploit" /><meta name="twitter:site" content="@_evilsaint_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-11T00:00:00+00:00","datePublished":"2022-01-11T00:00:00+00:00","description":"I void warranties","headline":"Searching Metasploit","mainEntityOfPage":{"@type":"WebPage","@id":"http://theevilsaint.github.io/posts/searching-metasploit/"},"url":"http://theevilsaint.github.io/posts/searching-metasploit/"}</script><title>Searching Metasploit | EvilSaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EvilSaint"><meta name="application-name" content="EvilSaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://evilsaint.com/static/images/evilsaint_shield_logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">EvilSaint</a></div><div class="site-subtitle font-italic">I void warranties</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/_evilsaint_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://evilsaint.com/subscribe" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/TheEvilSaint" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.instagram.com/therealevilsaint/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.facebook.com/TheEvilSaint/" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Searching Metasploit</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Searching Metasploit</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1641859200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 11, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="717 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="searching-metasploit">Searching Metasploit</h1><p>Search for payloads, exploits, or post modules</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">type</span><span class="ss">:payload</span>
<span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span>
<span class="n">search</span> <span class="n">type</span><span class="ss">:post</span>
</pre></table></code></div></div><p>Search for all modules that operate on a given port (e.g. FTP, SSH, HTTP)</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">port</span><span class="p">:</span><span class="mi">21</span>
<span class="n">search</span> <span class="n">port</span><span class="p">:</span><span class="mi">22</span>
<span class="n">search</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span>
</pre></table></code></div></div><p>Search all CVEs from 2011</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2011</span>
</pre></table></code></div></div><p>Careful when analysing the results of this above command. If you use the above example you might see a row like</p><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="//static/a706cbf8-d01d-4895-9c5d-ea82775626c3.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal">Snippet From Search for CVE from 2011</figcaption></figure><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="mi">68</span>   <span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">webapp</span><span class="o">/</span><span class="n">joomla_tinybrowser</span>                            <span class="mi">2009</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">22</span>
</pre></table></code></div></div><p>This example shows the disclosure date as a date in 2009. If we check the module however the module information. We can see the CVE is actually dated 2011 (<a href="https://nvd.nist.gov/vuln/detail/CVE-2011-4908">https://nvd.nist.gov/vuln/detail/CVE-2011-4908</a>)</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">info</span> <span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">webapp</span><span class="o">/</span><span class="n">joomla_tinybrowser</span>
</pre></table></code></div></div><p>Search by Exploit DB</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">edb</span><span class="p">:</span><span class="mi">9296</span>
</pre></table></code></div></div><p>Search for exploits by their AKA</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">aka</span><span class="ss">:shellshock</span>
<span class="n">search</span> <span class="n">aka</span><span class="ss">:heartbleed</span>
<span class="n">search</span> <span class="n">aka</span><span class="ss">:eternalblue</span>
</pre></table></code></div></div><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="//static/2dd2c2c8-f46d-4f43-ad73-d1688a5371de.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal">Metasploit Search For Heartbleed</figcaption></figure><p>Search by platform</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">platform</span><span class="ss">:windows</span>
<span class="n">search</span> <span class="n">platform</span><span class="ss">:linux</span>
<span class="n">search</span> <span class="n">platform</span><span class="ss">:mac</span>
</pre></table></code></div></div><p>Or exclude a platform</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span>
</pre></table></code></div></div><p>There are a few other options that we can add and we will go through some advanced search examples and introduce them.</p><p>In this search, we are looking for results that contain only exploits with an associated CVE released in 2017. We exclude any results that are for the Windows platform. Then we filter out by the exploits that operate on port 80 with a rank of ‘excellent’</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2017</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span> <span class="n">rank</span><span class="ss">:excellent</span>
</pre></table></code></div></div><p>As you can see we can get very specific in what we are looking for by chaining search criteria together.</p><p>If we add the word ‘check’ to the end of our search then we will only see modules that have a Metasploit check included.</p><aside> 💡 the `check` command is available for some modules. The check command is designed so you can test if the target is vulnerable before attempting to exploit it.</aside><p>The full command</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2017</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span> <span class="n">rank</span><span class="ss">:excellent</span> <span class="n">check</span> 
</pre></table></code></div></div><p>At the current time of writing, I am down to 5 results with the above search. We wanted to test all these modules but we wanted to order them. These are the modules as we currently see them.</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">#  Name                                                              Disclosure Date  Rank       Check  Description</span>
   <span class="o">-</span>  <span class="o">----</span>                                                              <span class="o">---------------</span>  <span class="o">----</span>       <span class="o">-----</span>  <span class="o">-----------</span>
   <span class="mi">0</span>  <span class="n">exploit</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">jenkins_cli_deserialization</span>                    <span class="mi">2017</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">26</span>       <span class="n">excellent</span>  <span class="no">Yes</span>    <span class="no">Jenkins</span> <span class="no">CLI</span> <span class="no">Deserialization</span>
   <span class="mi">1</span>  <span class="n">exploit</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">kaltura_unserialize_cookie_rce</span>                 <span class="mi">2017</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">12</span>       <span class="n">excellent</span>  <span class="no">Yes</span>    <span class="no">Kaltura</span> <span class="no">Remote</span> <span class="no">PHP</span> <span class="no">Code</span> <span class="no">Execution</span> <span class="n">over</span> <span class="no">Cookie</span>
   <span class="mi">2</span>  <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">october_upload_bypass_exec</span>                     <span class="mi">2017</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mi">25</span>       <span class="n">excellent</span>  <span class="no">Yes</span>    <span class="no">October</span> <span class="no">CMS</span> <span class="no">Upload</span> <span class="no">Protection</span> <span class="no">Bypass</span> <span class="no">Code</span> <span class="no">Execution</span>
   <span class="mi">3</span>  <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">shopware_createinstancefromnamedarguments_rce</span>  <span class="mi">2019</span><span class="o">-</span><span class="mo">05</span><span class="o">-</span><span class="mi">09</span>       <span class="n">excellent</span>  <span class="no">Yes</span>    <span class="no">Shopware</span> <span class="n">createInstanceFromNamedArguments</span> <span class="no">PHP</span> <span class="no">Object</span> <span class="no">Instantiation</span> <span class="no">RCE</span>
   <span class="mi">4</span>  <span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">zivif_ipcheck_exec</span>                              <span class="mi">2017</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mo">01</span>       <span class="n">excellent</span>  <span class="no">Yes</span>    <span class="no">Zivif</span> <span class="no">Camera</span> <span class="n">iptest</span><span class="p">.</span><span class="nf">cgi</span> <span class="no">Blind</span> <span class="no">Remote</span> <span class="no">Command</span> <span class="no">Execution</span>
</pre></table></code></div></div><p>If we add the <code class="language-shell highlighter-rouge"><span class="nt">-s</span></code> option we can pick a target field for us to search on. Options are “rank”, “disclosure_date”, “name”, “date”, “type”, “check”.</p><p>We can see from the example that the results are already sorted by name so <code class="language-shell highlighter-rouge"><span class="nt">-s</span> name</code> at first might seem pointless as this is the default.</p><ul><li>jenkins_cli_deserialization<li>kaltura_unserialize_cookie_rce<li>october_upload_bypass_exec<li>shopware_createinstancefromnamedarguments_rce<li>zivif_ipcheck_exec</ul><p>However, we can also reverse the search entries so we get the results starting Z and working back to J.</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2017</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span> <span class="n">rank</span><span class="ss">:excellent</span> <span class="n">check</span> <span class="o">-</span><span class="n">s</span> <span class="nb">name</span> <span class="o">-</span><span class="n">r</span>
</pre></table></code></div></div><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="//static/e83e8a98-93c0-46e4-a1a2-5f3ac4ad0111.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal">Reverse Name Order Search</figcaption></figure><p>Or we can search by date order (which of course can be reversed)</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2017</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span> <span class="n">rank</span><span class="ss">:excellent</span> <span class="n">check</span> <span class="o">-</span><span class="n">s</span> <span class="n">date</span>
<span class="n">search</span> <span class="n">type</span><span class="ss">:exploit</span> <span class="n">cve</span><span class="p">:</span><span class="mi">2017</span> <span class="n">platform</span><span class="p">:</span><span class="o">-</span><span class="n">windows</span> <span class="n">port</span><span class="p">:</span><span class="mi">80</span> <span class="n">rank</span><span class="ss">:excellent</span> <span class="n">check</span> <span class="o">-</span><span class="n">s</span> <span class="n">date</span> <span class="o">-</span><span class="n">r</span> 
</pre></table></code></div></div><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="//static/4b1d7537-a1d0-4f8d-9860-302f79e2c2da.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal">Reverse Date Order Search</figcaption></figure><p>What if we are happy with our results but we want to save them so we can work through them and mark them off? Metasploit allows you to export your results to a CSV</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>::ruby
search <span class="nb">type</span>:exploit cve:2017 platform:-windows port:80 rank:excellent check  <span class="nt">-o</span> /tmp/output.csv
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Wrote search results to /tmp/output.csv
</pre></table></code></div></div><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="//static/3714d5e4-addd-4458-8d4f-9783762aec6d.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal">Export to CSV</figcaption></figure><p>Another example where we search for all Metasploit modules of type exploit, for the Windows platform and operate on port 445 (SMB). We then specify the ‘check’ column as the search column meaning the exploits will be sorted by those that have a ‘check’ option first and then we output the result to CSV.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>::ruby
search <span class="nb">type</span>:exploit platform:windows port:445 <span class="nt">-s</span> check <span class="nt">-o</span> /tmp/windows-smb.csv
</pre></table></code></div></div><p>Lastly, what if we wanted to perform a search and then export that search to a CSV file as a oneliner without remaining in the Metasploit console.</p><div class="language-ruby highlighter-rouge"><div class="code-header"> <span data-label-text="Ruby"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">msfconsole</span> <span class="o">-</span><span class="n">qx</span> <span class="s1">'search type:exploit platform:windows port:445 -o /tmp/win-smb.csv;exit'</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/tutorial/'>tutorial</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/metasploit/" class="post-tag no-text-decoration" >metasploit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Searching+Metasploit+-+EvilSaint&url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsearching-metasploit%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Searching+Metasploit+-+EvilSaint&u=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsearching-metasploit%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsearching-metasploit%2F&text=Searching+Metasploit+-+EvilSaint" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsearching-metasploit%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/windows-registry/">Windows Registry</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/remote-exploit-ms17-010/"><div class="card-body"> <em class="small" data-ts="1616803200" data-df="ll" > Mar 27, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Remote Exploit MS17-010</h3><div class="text-muted small"><p> This article demonstrates how to exploit the MS17-010 vulnerability with the Metasploit Framework. This article is for educational purposes only. Two methods are demonstrated; with and without com...</p></div></div></a></div><div class="card"> <a href="/posts/rename-vmdk-disk-and-associated-files-vmware-virtual-disk-manager/"><div class="card-body"> <em class="small" data-ts="1618441200" data-df="ll" > Apr 15, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rename a VMDK disk and associated files with VMware Virtual Disk Manager</h3><div class="text-muted small"><p> I have a template Kali Linux Virtual Machine that I keep around in case in case of an unfixable error on my current engagement machine. The filenames inside this folder are quite verbose and are in...</p></div></div></a></div><div class="card"> <a href="/posts/using-screen-for-linux/"><div class="card-body"> <em class="small" data-ts="1618786800" data-df="ll" > Apr 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Moving Around The Terminal Like A Boss: Using Screen For Linux</h3><div class="text-muted small"><p> Installing Setting Name screen -S &amp;lt;my scans&amp;gt;</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/banner-grabbing-introduction/" class="btn btn-outline-primary" prompt="Older"><p>Banner Grabbing Introduction</p></a> <a href="//posts/vulnerabilities-ssl-tls-crime/" class="btn btn-outline-primary" prompt="Newer"><p>Vulnerabilities in SSL & TLS :- CRIME</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "TheEvilSaint/theevilsaint.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkyNTQ3ODQ3Nzk", "data-category": "Comments", "data-category-id": "DIC_kwDODy-1C84CSN7z", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available!</p><button type="button" class="btn btn-primary" aria-label="Update"> Update 🚀 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KK5XXRT4LD"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KK5XXRT4LD'); }); </script>
