<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="5 Uses for PowerShell on Pentests" /><meta property="og:locale" content="en" /><meta name="description" content="Five ways of using PowerShell on your pentests." /><meta property="og:description" content="Five ways of using PowerShell on your pentests." /><link rel="canonical" href="http://theevilsaint.github.io/posts/5-uses-powershell-pentests/" /><meta property="og:url" content="http://theevilsaint.github.io/posts/5-uses-powershell-pentests/" /><meta property="og:site_name" content="EvilSaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-15T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="5 Uses for PowerShell on Pentests" /><meta name="twitter:site" content="@_evilsaint_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-04-15T00:00:00+01:00","datePublished":"2021-04-15T00:00:00+01:00","description":"Five ways of using PowerShell on your pentests.","headline":"5 Uses for PowerShell on Pentests","mainEntityOfPage":{"@type":"WebPage","@id":"http://theevilsaint.github.io/posts/5-uses-powershell-pentests/"},"url":"http://theevilsaint.github.io/posts/5-uses-powershell-pentests/"}</script><title>5 Uses for PowerShell on Pentests | EvilSaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EvilSaint"><meta name="application-name" content="EvilSaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://evilsaint.com/static/images/evilsaint_shield_logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">EvilSaint</a></div><div class="site-subtitle font-italic">I void warranties</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/_evilsaint_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://evilsaint.com/subscribe" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/TheEvilSaint" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.instagram.com/therealevilsaint/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.facebook.com/TheEvilSaint/" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>5 Uses for PowerShell on Pentests</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>5 Uses for PowerShell on Pentests</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1618441200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 15, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="774 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h2 id="1-checking-for-duplicate-files"><span class="mr-2">1, Checking for duplicate files</span><a href="#1-checking-for-duplicate-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Finding duplicate files can be a tricky task, especially when you have 100’s of files spread all over your hard drive. An easy way is to compute the checksum of the files you would like to check and compare them. If we generate checksums for two files, we can declare that the two files aren’t duplicates if the checksums are different. If the checksums are equal, we can claim that the files are identical, considering that getting the same hash for two different files is almost impossible.</p><p>Collisions can occur with Sha1 and MD5, so it is recommended you either double-check with both algorithms (as a collision on both will be unlikely) or use an algorithm such as Sha512.</p><p>We can use the following function to get the checksum of any file.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Get-FileHash</span><span class="w"> </span><span class="nt">-Algorithm</span><span class="w"> </span><span class="nx">sha1</span><span class="w"> </span><span class="nx">file.txt</span><span class="w">
</span></pre></table></code></div></div><p>The <code class="language-shell highlighter-rouge">Get-FileHash</code> algorithm attribute supports the following:</p><ul><li>SHA1 (160 bits)<li>SHA256 (256 bits)<li>SHA384 (384 bits)<li>SHA512 (512 bits)<li>MACTripleDES (64 bits)<li>MD5 (128 bits)<li>RIPEMD160 (160 bits)</ul><p><img data-src="//static/ea89c0fc-5aea-4f88-9257-4ca0e3121921.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><h2 id="2-create-iso-files"><span class="mr-2">2 Create ISO files</span><a href="#2-create-iso-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="what-are-iso-files"><span class="mr-2">What are ISO files?</span><a href="#what-are-iso-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ISOs are a type of archive. The easiest way to think of an ISO file is more like a .zip or .cab archive file, only without the compression. An ISO file contains the image of a disk. That means it contains all the files and folders on that disk, much like a .zip or .cab file containing a collection of files and folders.</p><h3 id="what-are-some-of-the-benefits-of-iso-files"><span class="mr-2">What are some of the benefits of ISO files.</span><a href="#what-are-some-of-the-benefits-of-iso-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Chances of getting viruses in your file are reduced.<li>Chances of your data being corrupt are reduced after creating an ISO file.<li>A single ISO file can hold a whole batch of files and tools.</ul><p>Using the code, we can find it at the following location. We can create an ISO file for storing tools and documents inside and mounting them inside our virtual machines.</p><p><a href="https://gallery.technet.microsoft.com/scriptcenter/New-ISOFile-function-a8deeffd">New-ISOFile function</a></p><p>To make the script easier to call, we will put it in our profile. See the following link for more information about PowerShell profiles and the appropriate location.</p><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.1#the-profile-files">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.1#the-profile-files</a></p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">New-Item</span><span class="w"> </span><span class="nt">-ItemType</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nv">$Home</span><span class="nx">\Documents\PowerShell\</span><span class="w">
</span><span class="n">New-Item</span><span class="w"> </span><span class="nv">$Home</span><span class="nx">\Documents\PowerShell\Profile.ps1</span><span class="w">
</span><span class="n">notepad</span><span class="w"> </span><span class="nv">$Home</span><span class="nx">\Documents\PowerShell\Profile.ps1</span><span class="w">
</span></pre></table></code></div></div><p><img data-src="//static/b997e7f9-e47c-4b85-8ca3-7973dd4dd150.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>With the function saved in our profile, we can now create an ISO. Let us use the text files we created earlier.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">gci</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">New-ISOFile</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">textfile.iso</span><span class="w">
</span></pre></table></code></div></div><p><img data-src="//static/099f6a05-4dd0-48b1-93ef-f7f18d4987d3.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Lets now mount the disk and boot up our VM</p><p><img data-src="//static/a1907569-7cbb-4654-8c61-749523497c25.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Setting the CD player path to the path of the ISO we just created.</p><p><img data-src="//static/98a87e5c-8ad8-452d-bd90-31f5e01e3f37.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>The drive has appeared and seems to have content in it.</p><p>Let’s hit <code class="language-shell highlighter-rouge">Ctrl</code> + <code class="language-shell highlighter-rouge">E</code> to open up Explorer and navigate our mounted ISO.</p><p><img data-src="//static/24ba6ce8-449c-4c35-ad9f-ebcb72de8954.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Out ISO contains the three files from earlier.</p><h2 id="3-using-powershell-to-show-server-response-headers"><span class="mr-2">3, Using PowerShell to Show Server Response Headers</span><a href="#3-using-powershell-to-show-server-response-headers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using the <code class="language-shell highlighter-rouge">Invoke-WebRequest</code> or the valid and shortened <code class="language-shell highlighter-rouge">iwr</code>, we can retrieve interesting information.</p><p>The returned object from <code class="language-shell highlighter-rouge">Invoke-WebRequest</code> will allow you to see items such as the returned HTTP status code, the links on a page, the forms on the page and the returned server headers.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nx">https://evilsaint.co.uk</span><span class="w">
</span><span class="nv">$request</span><span class="o">.</span><span class="nf">StatusCode</span><span class="w">
</span><span class="nv">$request</span><span class="o">.</span><span class="nf">Headers</span><span class="w">
</span><span class="nv">$request</span><span class="o">.</span><span class="nf">RawContent</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">temp.html</span><span class="w">
</span></pre></table></code></div></div><p>What these Headers mean I will leave for a future article, but here is a useful reference in the mean-time:</p><p><a href="https://flaviocopes.com/http-response-headers/">The HTTP Response Headers List</a></p><p><img data-src="//static/aee90e1c-ba46-4a56-920d-9b57a75268a8.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Here we can see the headers returned by the server when making a GET request to <a href="https://evilsaint.com">evilsaint.com</a></p><h2 id="4-checking-what-versions-of-ssltls-the-server-will-support"><span class="mr-2">4, Checking what versions of SSL/TLS the server will support</span><a href="#4-checking-what-versions-of-ssltls-the-server-will-support" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="err">“</span><span class="n">ssl2</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="nx">ssl3</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="nx">tls</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="nx">tls11</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="nx">tls12</span><span class="err">”</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w">

    </span><span class="nv">$TcpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Net.Sockets.TcpClient</span><span class="w">
    </span><span class="nv">$TcpClient</span><span class="o">.</span><span class="nf">Connect</span><span class="p">(</span><span class="s2">"evilsaint.com"</span><span class="p">,</span><span class="w"> </span><span class="nx">443</span><span class="p">)</span><span class="w">
    </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$SslStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">Net.Security.SslStream</span><span class="w"> </span><span class="nv">$TcpClient</span><span class="o">.</span><span class="nf">GetStream</span><span class="p">()</span><span class="w">
        </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">ReadTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15000</span><span class="w">
        </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">WriteTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15000</span><span class="w">
        </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">AuthenticateAsClient</span><span class="p">(</span><span class="s2">"evilsaint.com"</span><span class="p">,</span><span class="bp">$null</span><span class="p">,</span><span class="bp">$_</span><span class="p">,</span><span class="bp">$false</span><span class="p">)</span><span class="w">
        </span><span class="nv">$KeyExhange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">KeyExchangeAlgorithm</span><span class="w">
        </span><span class="nv">$HashAlgorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">HashAlgorithm</span><span class="w">
        </span><span class="nv">$status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">

    </span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="nv">$TcpClient</span><span class="o">.</span><span class="nf">Dispose</span><span class="p">()</span><span class="w">
    </span><span class="nv">$SslStream</span><span class="o">.</span><span class="nf">Dispose</span><span class="p">()</span><span class="w">

    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"</span><span class="bp">$_</span><span class="s2"> = </span><span class="nv">$status</span><span class="s2">"</span><span class="w">
    </span><span class="c">#Write-Host $KeyExhange</span><span class="w">
    </span><span class="c">#Write-Host $HashAlgorithm</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><img data-src="//static/ee1e0133-5cee-4894-9031-35565478119d.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Here we can see that <a href="https://evilsaint.com">evilsaint.com</a> does not support SSL version 2 or 3</p><h2 id="5-alive-hosts-and-open-port-detection"><span class="mr-2">5, Alive Hosts And Open Port Detection</span><a href="#5-alive-hosts-and-open-port-detection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>While ideally, we would always have tools such as Nmap, Masscan and Hping3 to hand, sometimes, we just had to live-of-the-land.</p><p>To see if a host is alive, we can use <code class="language-shell highlighter-rouge">Test-NetConnection</code> to send an ICMP ping request.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Test-NetConnection</span><span class="w"> </span><span class="nx">evilsaint.com</span><span class="w">
</span></pre></table></code></div></div><p>If we specify a port, then PowerShell will attempt a TCP connect test to that port.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Test-NetConnection</span><span class="w"> </span><span class="p">[</span><span class="n">evilsaint.com</span><span class="p">](</span><span class="n">http://evilsaint.com/</span><span class="p">)</span><span class="w"> </span><span class="nt">-Port</span><span class="w"> </span><span class="mi">443</span><span class="w">
</span></pre></table></code></div></div><p>With a little scripting, we can use the Net Sockets TCP Client and loop through many ports like so</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="mi">1</span><span class="o">..</span><span class="mi">1024</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="n">echo</span><span class="w"> </span><span class="p">((</span><span class="n">new-object</span><span class="w"> </span><span class="nx">Net.Sockets.TcpClient</span><span class="p">)</span><span class="o">.</span><span class="nf">Connect</span><span class="p">(</span><span class="s2">"[evilsaint.com](http://evilsaint.com/)"</span><span class="p">,</span><span class="err">$</span><span class="o">*</span><span class="p">))</span><span class="w"> </span><span class="s2">"Port </span><span class="err">$</span><span class="s2">* is open!"</span><span class="p">}</span><span class="w"> </span><span class="mi">2</span><span class="err">&gt;</span><span class="bp">$null</span><span class="w">
</span></pre></table></code></div></div><p>This can be quite a slow process.</p><p><img data-src="//static/ca18b1d9-c600-48ae-9082-fd3ecbb01b35.png" class="img-fluid" alt="untitled" data-proofer-ignore></p><p>Here we can see Port 22 has been left open :-)</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/article/'>article</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/powershell/" class="post-tag no-text-decoration" >powershell</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=5+Uses+for+PowerShell+on+Pentests+-+EvilSaint&url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2F5-uses-powershell-pentests%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=5+Uses+for+PowerShell+on+Pentests+-+EvilSaint&u=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2F5-uses-powershell-pentests%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2F5-uses-powershell-pentests%2F&text=5+Uses+for+PowerShell+on+Pentests+-+EvilSaint" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2F5-uses-powershell-pentests%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/windows-registry/">Windows Registry</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/making-a-youtube-scraper/"><div class="card-body"> <em class="small" data-ts="1629846000" data-df="ll" > Aug 25, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Making A YouTube Scraper</h3><div class="text-muted small"><p> Making A YouTube Scraper PowerShell What do we need: Get an API Credential for Youtube Query the data from Google API ** Get API Credential for YouTube ** Step 1 First navigate to the fo...</p></div></div></a></div><div class="card"> <a href="/posts/powershell-memory-injection-using-certutilexe/"><div class="card-body"> <em class="small" data-ts="1652828400" data-df="ll" > May 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PowerShell: In-Memory Injection Using CertUtil.exe</h3><div class="text-muted small"><p> PowerShell is still one of the easiest and best ways to gain a foothold, but at the same time, it is selling you out because it talks to AMSI as soon as it’s run. The beauty of this method is ...</p></div></div></a></div><div class="card"> <a href="/posts/fixing-common-errors-powershell-remoting-kali/"><div class="card-body"> <em class="small" data-ts="1645747200" data-df="ll" > Feb 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fixing Common Errors PowerShell Remoting From Kali</h3><div class="text-muted small"><p> Assuming you have powershell installed on Kali. // Insert link or brief description of installing PowerShell on Kali. Problem 1 When you try and perform PowerShell remoting the first time you wi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/remote-exploit-ms17-010/" class="btn btn-outline-primary" prompt="Older"><p>Remote Exploit MS17-010</p></a> <a href="//posts/auditing-cisco-network-devices/" class="btn btn-outline-primary" prompt="Newer"><p>Auditing Cisco Network Devices</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "TheEvilSaint/theevilsaint.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkyNTQ3ODQ3Nzk", "data-category": "Comments", "data-category-id": "DIC_kwDODy-1C84CSN7z", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available!</p><button type="button" class="btn btn-primary" aria-label="Update"> Update 🚀 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KK5XXRT4LD"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KK5XXRT4LD'); }); </script>
