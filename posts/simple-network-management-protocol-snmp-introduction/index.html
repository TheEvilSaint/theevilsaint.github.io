<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Simple Network Management Protocol (SNMP) :- Introduction" /><meta property="og:locale" content="en" /><meta name="description" content="I void warranties" /><meta property="og:description" content="I void warranties" /><link rel="canonical" href="http://theevilsaint.github.io/posts/simple-network-management-protocol-snmp-introduction/" /><meta property="og:url" content="http://theevilsaint.github.io/posts/simple-network-management-protocol-snmp-introduction/" /><meta property="og:site_name" content="EvilSaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-19T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Simple Network Management Protocol (SNMP) :- Introduction" /><meta name="twitter:site" content="@_evilsaint_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-01-19T00:00:00+00:00","datePublished":"2021-01-19T00:00:00+00:00","description":"I void warranties","headline":"Simple Network Management Protocol (SNMP) :- Introduction","mainEntityOfPage":{"@type":"WebPage","@id":"http://theevilsaint.github.io/posts/simple-network-management-protocol-snmp-introduction/"},"url":"http://theevilsaint.github.io/posts/simple-network-management-protocol-snmp-introduction/"}</script><title>Simple Network Management Protocol (SNMP) :- Introduction | EvilSaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EvilSaint"><meta name="application-name" content="EvilSaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://evilsaint.com/static/images/evilsaint_shield_logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">EvilSaint</a></div><div class="site-subtitle font-italic">I void warranties</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/_evilsaint_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://evilsaint.com/subscribe" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/TheEvilSaint" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.instagram.com/therealevilsaint/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.facebook.com/TheEvilSaint/" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Simple Network Management Protocol (SNMP) :- Introduction</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Simple Network Management Protocol (SNMP) :- Introduction</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1611014400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 19, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1332 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>SNMP stands for Simple Network Management Protocol. It is generally used by network monitoring applications to read and write network state variables (state of the interface, no. of sent packets etc.). Types of managed devices include servers, workstations and network devices.</p><p>SNMP services run by default on the 161 UDP port.</p><p>SNMP communications are generally protected by using an authentication string called community string. There are two types of community strings, a read-only community string that gives us access to the general variables of the network and a read-write one, that also allows us to set specific variables.</p><p>If you can “guess” the read-only or read-write strings you can obtain quite a bit of access you would not normally have. In addition, if Windows based devices are configured with SNMP, often times with the RO/RW community strings, you can extract patch levels, services running, last reboot times, usernames on the system, routes, and various other amounts of information that is valuable to an attacker.</p><p>If you can find a Cisco device running a private string for example, you can actually download the entire device configuration, modify it, and upload your own malicious config. Often the passwords themselves are level 7 encoded which means they are trivial to decode and obtain the ‘enable‘ or login password for the specific device</p><p>When querying through SNMP, there is what’s called an MIB API. The MIB stands for the Management Information Base (MIB). This interface allows you to query the device and extract information.</p><p>RFC MIB = http://www.oidview.com/mibs/0/HOST-RESOURCES-MIB.html</p><p>VENDOR SPECIFIC = http://www.oidview.com/mibs/detail.html</p><p>MICROSOFT = http://www.oidview.com/mibs/311/md-311-1.html</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1.3.6.1.2.1.25.1.6.0 System Processes  
1.3.6.1.2.1.25.4.2.1.2 Running Programs  
1.3.6.1.2.1.25.4.2.1.4 Processes Path  
1.3.6.1.2.1.25.2.3.1.4 Storage Units  
1.3.6.1.2.1.25.6.3.1.2 Software Name  
1.3.6.1.4.1.77.1.2.25 User Accounts  
1.3.6.1.2.1.6.13.1.3 TCP Local Ports  
</pre></table></code></div></div><h2 id="snmpwalk"><span class="mr-2">SNMPWalk</span><a href="#snmpwalk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Snmpwalk is a popular tool for testing SNMP. This tool acts as SNMP client, and we can use it for our penetration testing where we require making requests to the SNMP service on the target host.</p><h3 id="common-usage"><span class="mr-2">Common Usage</span><a href="#common-usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Shows Help</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">--help</span>
</pre></table></code></div></div><p>Looks at one host, specifying a community string of public</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.22
</pre></table></code></div></div><p>Here we are asking snmpwalk to walk one node subset in the MIB</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.22 .1.3.6.1.2.1.25.1.6.0
</pre></table></code></div></div><p><code class="language-shell highlighter-rouge"><span class="nt">-M</span></code> option allows us to include a file of MIB’s to look throgh</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.22 <span class="nt">-M</span> mibs.txt
</pre></table></code></div></div><p>Some MIB nodes display in hex, in order to force display of those in ASCI we add the -Oa options</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.73 iso.3.6.1.2.1.2.2.1.2 <span class="nt">-Oa</span>
</pre></table></code></div></div><p>Adding the <code class="language-shell highlighter-rouge">n</code> to the <code class="language-shell highlighter-rouge"><span class="nt">-O</span></code> option means it displays full OID’s</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.73 iso.3.6.1.2.1.2.2.1.2 <span class="nt">-Oan</span>
</pre></table></code></div></div><p>Searching snmpwalk for a specific MID string.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">for </span>ip <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>out | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f1</span> | <span class="nb">sort</span> <span class="nt">-u</span> | <span class="nb">grep</span> <span class="s2">"10.11"</span><span class="si">)</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="nv">$ip</span> <span class="p">;</span>
snmpwalk <span class="nt">-c</span> public <span class="nt">-v1</span> <span class="nv">$ip</span> 1.3.6.1.2.1.25.4.2.1.2 <span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>Filtering output of a lookup for a specific string</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snmpwalk <span class="nt">-v</span> 1 <span class="nt">-c</span> public 10.11.1.73 <span class="nt">-Oa</span> | <span class="nb">grep</span> <span class="s2">"iso.3.6.1.2.1.2.2.1.2"</span>
</pre></table></code></div></div><h3 id="important-mibs-id-for-pentestesters"><span class="mr-2">Important MIB’s ID for Pentestesters</span><a href="#important-mibs-id-for-pentestesters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="windows"><span class="mr-2">Windows</span><a href="#windows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>RUNNING PROCESSES 1.3.6.1.2.1.25.4.2.1.2  
INSTALLED SOFTWARE 1.3.6.1.2.1.25.6.3.1.2  
SYSTEM INFO 1.3.6.1.2.1.1.1  
HOSTNAME 1.3.6.1.2.1.1.5  
DOMAIN 1.3.6.1.4.1.77.1.4.1  
UPTIME 1.3.6.1.2.1.1.3  
USERS 1.3.6.1.4.1.77.1.2.25  
SHARES 1.3.6.1.4.1.77.1.2.27  
DISKS 1.3.6.1.2.1.25.2.3.1.3  
SERVICES 1.3.6.1.4.1.77.1.2.3.1.1  
LISTENING TCP PORTS 1.3.6.1.2.1.6.13.1.3.0.0.0.0  
LISTENING UDP PORTS 1.3.6.1.2.1.7.5.1.2.0.0.0.0  
SYSTEM PROCESSES 1.3.6.1.2.1.25.1.6.0  
STORAGE UNITS 1.3.6.1.2.1.25.2.3.1.4  
</pre></table></code></div></div><h4 id="linux"><span class="mr-2">Linux</span><a href="#linux" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>RUNNING PROCESSES 1.3.6.1.2.1.25.4.2.1.2  
SYSTEM INFO 1.3.6.1.2.1.1.1  
HOSTNAME 1.3.6.1.2.1.1.5  
UPTIME 1.3.6.1.2.1.1.3  
MOUNTPOINTS 1.3.6.1.2.1.25.2.3.1.3  
RUNNING SOFTWARE PATHS 1.3.6.1.2.1.25.4.2.1.4  
LISTENING UDP PORTS 1.3.6.1.2.1.7.5.1.2.0.0.0.0  
LISTENING TCP PORTS 1.3.6.1.2.1.6.13.1.3.0.0.0.0  
SYSTEM PROCESSES 1.3.6.1.2.1.25.1.6.0  
STORAGE UNITS 1.3.6.1.2.1.25.2.3.1.4  
</pre></table></code></div></div><h4 id="cisco"><span class="mr-2">Cisco</span><a href="#cisco" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>LAST TERMINAL USERS 1.3.6.1.4.1.9.9.43.1.1.6.1.8  
INTERFACES 1.3.6.1.2.1.2.2.1.2  
SYSTEM INFO 1.3.6.1.2.1.1.1  
HOSTNAME 1.3.6.1.2.1.1.5  
SNMPcommunities 1.3.6.1.6.3.12.1.3.1.4  
UPTIME 1.3.6.1.2.1.1.3  
IP ADDRESSES 1.3.6.1.2.1.4.20.1.1  
INTERFACE DESCRIPTIONS 1.3.6.1.2.1.31.1.1.1.18  
HARDWARE 1.3.6.1.2.1.47.1.1.1.1.2  
TACACS SERVER 1.3.6.1.4.1.9.2.1.5  
LOGMESSAGES 1.3.6.1.4.1.9.9.41.1.2.3.1.5  
PROCESSES 1.3.6.1.4.1.9.9.109.1.2.1.1.2  
SNMP TRAP SERVER 1.3.6.1.6.3.12.1.2.1.7<span class="sb">`</span>
</pre></table></code></div></div><h2 id="snmp-check"><span class="mr-2">snmp-check</span><a href="#snmp-check" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><code class="language-shell highlighter-rouge">snmp-check</code> allows you to enumerate the SNMP devices and places the output in a very human readable friendly format. It could be useful for penetration testing or systems monitoring.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>snmp-check <span class="nt">-w</span> ip_address
<span class="nt">-p</span>, <span class="nt">--port</span> : SNMP port<span class="p">;</span> default port is 161<span class="p">;</span>
<span class="nt">-c</span>, <span class="nt">--community</span>: SNMP community<span class="p">;</span> default is public<span class="p">;</span>
<span class="nt">-v</span>, <span class="nt">--version</span> : SNMP version <span class="o">(</span>1,2c<span class="o">)</span><span class="p">;</span> default is 1<span class="p">;</span>
<span class="nt">-w</span>, <span class="nt">--write</span> : detect write access <span class="o">(</span>separate action by enumeration<span class="o">)</span><span class="p">;</span>
<span class="nt">-d</span>, <span class="nt">--disable_tcp</span> : disable <span class="s1">'TCP
</span></pre></table></code></div></div><h2 id="snmpset"><span class="mr-2">snmpset</span><a href="#snmpset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If we find write access to an SNMP server we can use snmpset to write to it.</p><p><code class="language-shell highlighter-rouge">snmpset</code> - communicates with a network entity using SNMP SET requests</p><h2 id="onesixtyone"><span class="mr-2">Onesixtyone</span><a href="#onesixtyone" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Onesixtyone is an SNMP scanner that sends multiple SNMP requests to multiple IP addresses, trying different community strings and waiting for replies.</p><p>Key Features</p><ul><li>Very fast scanning speed (over 50,000 guesses per second)<li>Scan a single host or thousands of hosts at the same time<li>You can tune scan speed to support both LAN and WAN testing</ul><h3 id="prepping-your-dictionary"><span class="mr-2">Prepping Your Dictionary</span><a href="#prepping-your-dictionary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>SNMP strings in onesixtyone can’t be longer than 16 characters at time of this writing. If you have an error with your dictionary file you can find out which words are causing problems with the following command.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat </span>snmpstrings.txt | <span class="nb">grep</span> <span class="nt">-xv</span> .<span class="se">\{</span>0,16<span class="se">\}</span>
</pre></table></code></div></div><p>There is a current approve request in onesixtyone to increase the size as currently the following string which is default in the kali linux wordlists for snmp community strings can not be parsed for onesixtyone.</p><p>This is the APC default community string:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TENmanUFactOryPOWER
</pre></table></code></div></div><p>However if you wish to use onesixtyone and you need to filter your list down you can do the following to pipe all the words between 0-16 characters into a new list</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cat </span>snmpstrings.txt | <span class="nb">grep</span> <span class="nt">-x</span> <span class="s1">'.\{0,16\}'</span> <span class="o">&gt;</span> snmp.txt
</pre></table></code></div></div><h3 id="example-usage"><span class="mr-2">Example usage</span><a href="#example-usage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Scanning Hosts/Community Strings From Files</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>onesixtyone <span class="nt">-c</span> snmp.txt <span class="nt">-i</span> opensnmp.txt 
<span class="nt">-i</span> <span class="o">=</span> This flag allows you to input hosts from a list
<span class="nt">-c</span> <span class="o">=</span> This flag allows you to input community strings from a list.
</pre></table></code></div></div><p>Scanning a single host.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>onesixtyone <span class="nt">-c</span> /dict/snmp.txt 10.0.0.1
</pre></table></code></div></div><h3 id="key-flags"><span class="mr-2">Key Flags</span><a href="#key-flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">-c</span> <span class="o">=</span> file with community string names to try
<span class="nt">-i</span> <span class="o">=</span> file with target hosts
<span class="nt">-o</span> <span class="o">=</span> output log
<span class="nt">-d</span> <span class="o">=</span> debug mode
<span class="nt">-w</span> <span class="o">=</span> Wait <span class="k">in </span>milliseconds between sending packets <span class="o">(</span>default 10<span class="o">)</span>
<span class="nt">-q</span> <span class="o">=</span> Quiet mode, <span class="k">do </span>not print to std out.
</pre></table></code></div></div><p>Brute Force And Scan Network SNMP bruteforce script.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>root@kali:/# <span class="nb">echo</span> <span class="s2">"public"</span> <span class="o">&gt;</span> community
root@kali:/# <span class="nb">echo</span> <span class="s2">"private"</span> <span class="o">&gt;</span> community
root@kali:/# <span class="nb">echo</span> <span class="s2">"manager"</span> <span class="o">&gt;</span> community
root@kali:/# <span class="k">for </span>ip <span class="k">in</span> <span class="si">$(</span><span class="nb">seq </span>200 254<span class="si">)</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo </span>192.168.19.<span class="nv">$ip</span> <span class="p">;</span><span class="k">done</span> <span class="o">&gt;</span> ips.txt
root@kali:/# onesixtyone <span class="nt">-c</span> community <span class="nt">-i</span> ips.txt
</pre></table></code></div></div><h2 id="snmp-with-nmap"><span class="mr-2">SNMP with NMAP</span><a href="#snmp-with-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is a standard network scan looking for potential snmp open port hosts.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>nmap <span class="nt">-Pn</span> <span class="nt">-sU</span> <span class="nt">-sV</span> <span class="nt">-p</span> 161 <span class="nt">--open</span> 10.0.0.1/24
<span class="nt">-Pn</span> <span class="o">=</span> Treat all hosts as online 
<span class="nt">-sU</span> <span class="o">=</span> Specifys a UDP Scan
<span class="nt">-p</span> <span class="o">=</span> Specify the port
<span class="nt">-sV</span> <span class="o">=</span> Specify to perform service enumeration
<span class="nt">--open</span> <span class="o">=</span> Returns on Open Ports
</pre></table></code></div></div><p>This should hopefully tell us the version number of the SNMP. Now we can run nmap with scripts to further enumerate</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-Pn</span> <span class="nt">-sU</span> <span class="nt">-p</span> 161 10.0.0.1 <span class="nt">--script</span><span class="o">=</span>snmp-brute
</pre></table></code></div></div><h3 id="nmap-nse-scripts-for-snmp"><span class="mr-2">NMAP NSE Scripts for SNMP</span><a href="#nmap-nse-scripts-for-snmp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cd</span> <span class="s2">"/usr/share/nmap/scripts"</span>
<span class="nb">ls</span> <span class="nt">-la</span> | <span class="nb">grep</span> <span class="s2">"snmp"</span>
</pre></table></code></div></div><h4 id="flags"><span class="mr-2">Flags</span><a href="#flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>snmp-brute <span class="o">=</span> Attempts to find an SNMP community string by brute force guessing
snmp-hh3c-logins <span class="o">=</span> Attempts to enumerate Huawei / HP/H3C Locally Defined Users
snmp-info <span class="o">=</span> Extracts basic information from an SNMPv3 GET request
snmp-interfaces <span class="o">=</span> Attempts to enumerate network interfaces through SNMP
snmp-ios-config <span class="o">=</span> Attempts to download Cisco router IOS configuration files
snmp-netstat <span class="o">=</span> Attempts to query SNMP <span class="k">for </span>a netstat like output
snmp-processes <span class="o">=</span> Attempts to enumerate running processes through SNMP
snmp-sysdescr <span class="o">=</span> Attempts to extract system information from an SNMP version 1 service
snmp-win32-services <span class="o">=</span> Attempts to enumerate Windows services through SNMP
snmp-win32-shares <span class="o">=</span> Attempts to enumerate Windows Shares through SNMP.
snmp-win32-software <span class="o">=</span> Attempts to enumerate installed software through SNMP.
snmp-win32-users <span class="o">=</span> Attempts to enumerate Windows user accounts through SNMP
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/tutorial/'>tutorial</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/snmp/" class="post-tag no-text-decoration" >snmp</a> <a href="//tags/snmpwalk/" class="post-tag no-text-decoration" >snmpwalk</a> <a href="//tags/community-string/" class="post-tag no-text-decoration" >community-string</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Simple+Network+Management+Protocol+%28SNMP%29+%3A-+Introduction+-+EvilSaint&url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsimple-network-management-protocol-snmp-introduction%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Simple+Network+Management+Protocol+%28SNMP%29+%3A-+Introduction+-+EvilSaint&u=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsimple-network-management-protocol-snmp-introduction%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsimple-network-management-protocol-snmp-introduction%2F&text=Simple+Network+Management+Protocol+%28SNMP%29+%3A-+Introduction+-+EvilSaint" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fsimple-network-management-protocol-snmp-introduction%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/windows-registry/">Windows Registry</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/rename-vmdk-disk-and-associated-files-vmware-virtual-disk-manager/"><div class="card-body"> <em class="small" data-ts="1618441200" data-df="ll" > Apr 15, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rename a VMDK disk and associated files with VMware Virtual Disk Manager</h3><div class="text-muted small"><p> I have a template Kali Linux Virtual Machine that I keep around in case in case of an unfixable error on my current engagement machine. The filenames inside this folder are quite verbose and are in...</p></div></div></a></div><div class="card"> <a href="/posts/using-screen-for-linux/"><div class="card-body"> <em class="small" data-ts="1618786800" data-df="ll" > Apr 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Moving Around The Terminal Like A Boss: Using Screen For Linux</h3><div class="text-muted small"><p> Installing Setting Name 1 screen -S &amp;lt;my scans&amp;gt;</p></div></div></a></div><div class="card"> <a href="/posts/covert-voice-video-text/"><div class="card-body"> <em class="small" data-ts="1619218800" data-df="ll" > Apr 24, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Covert Voice In A Video To Text</h3><div class="text-muted small"><p> Have you ever wanted to extract the text from a video file? There are a number of software packages and transcription services flooding the search engines and it can be hard to pick a piece of soft...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/customising-windows-10/" class="btn btn-outline-primary" prompt="Older"><p>Customising Windows 10</p></a> <a href="//posts/remote-ssh-access-tutorial/" class="btn btn-outline-primary" prompt="Newer"><p>Remote SSH Access tutorial</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "TheEvilSaint/theevilsaint.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkyNTQ3ODQ3Nzk", "data-category": "Comments", "data-category-id": "DIC_kwDODy-1C84CSN7z", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available!</p><button type="button" class="btn btn-primary" aria-label="Update"> Update 🚀 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KK5XXRT4LD"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KK5XXRT4LD'); }); </script>
