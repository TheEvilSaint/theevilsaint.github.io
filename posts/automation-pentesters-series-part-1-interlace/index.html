<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Automation For Pentesters Series - Part 1 Interlace" /><meta property="og:locale" content="en" /><meta name="description" content="I void warranties" /><meta property="og:description" content="I void warranties" /><link rel="canonical" href="http://theevilsaint.github.io/posts/automation-pentesters-series-part-1-interlace/" /><meta property="og:url" content="http://theevilsaint.github.io/posts/automation-pentesters-series-part-1-interlace/" /><meta property="og:site_name" content="EvilSaint" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-11T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automation For Pentesters Series - Part 1 Interlace" /><meta name="twitter:site" content="@_evilsaint_" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-06-11T00:00:00+01:00","datePublished":"2021-06-11T00:00:00+01:00","description":"I void warranties","headline":"Automation For Pentesters Series - Part 1 Interlace","mainEntityOfPage":{"@type":"WebPage","@id":"http://theevilsaint.github.io/posts/automation-pentesters-series-part-1-interlace/"},"url":"http://theevilsaint.github.io/posts/automation-pentesters-series-part-1-interlace/"}</script><title>Automation For Pentesters Series - Part 1 Interlace | EvilSaint</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="EvilSaint"><meta name="application-name" content="EvilSaint"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://evilsaint.com/static/images/evilsaint_shield_logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">EvilSaint</a></div><div class="site-subtitle font-italic">I void warranties</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://twitter.com/_evilsaint_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://evilsaint.com/subscribe" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href="https://github.com/TheEvilSaint" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.instagram.com/therealevilsaint/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.facebook.com/TheEvilSaint/" aria-label="facebook" target="_blank" rel="noopener"> <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Automation For Pentesters Series - Part 1 Interlace</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Automation For Pentesters Series - Part 1 Interlace</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1623366000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 11, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1288 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><h2 id="instalation"><span class="mr-2">Instalation</span><a href="#instalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h5 class="step"> Step one, we clone the package from Github</h5><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>git clone https://github.com/codingo/Interlace.git /opt/Interlace
</pre></table></code></div></div><h5 class="step"> Step two, enter the directory and setup virtual environment</h5><p>This step is optional but if you do not follow then you will install all the python packages globally which may or may not be a good thing depending on setup.</p><p>We use the <code class="language-shell highlighter-rouge"><span class="nb">cd</span></code> command to change the directory and the <code class="language-shell highlighter-rouge">virtualenv</code> command</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cd</span> /opt/Interlace
virtualenv venv
<span class="nb">source </span>venv/bin/activate
</pre></table></code></div></div><h5 class="step"> Step three, we install the program</h5><p>First the Pip packages</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip3 <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
</pre></table></code></div></div><p>Then install via the setup.py</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>python3.9 setup.py <span class="nb">install</span>
</pre></table></code></div></div><blockquote><p>This took a few minutes for me so maybe now is the time for that coffee.</p></blockquote><p>If you install interlace in a virtual environment then you will need to activate that environment before you use it</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">source</span> /opt/Interlace/venv/bin/activate
interlace <span class="nt">-h</span>
</pre></table></code></div></div><h2 id="scanning"><span class="mr-2">Scanning</span><a href="#scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In the following examples, we will be looking at scans against one IP and multiple IP lists to compare.</p><p>I have completed a discovery scan and I have the following IP addresses</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nb">cat </span>nmap-discovery.gnmap | <span class="nb">grep</span> <span class="s1">'Status: Up'</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">" "</span> <span class="nt">-f</span> 2 | <span class="nb">tee </span>targets.txt
10.10.10.4
10.10.10.43
10.10.10.63
10.10.10.68
10.10.10.134
10.10.10.229
10.10.10.239
10.10.10.245
</pre></table></code></div></div><p>I will put them in a file called <code class="language-shell highlighter-rouge">targets.txt</code> while we look at the syntax. Interlace allows us to run commands with things like thread taken care of. It allows variable substitution to keep scans looking uniform and handles some advanced functionality we would have to code ourselves.</p><h3 id="blockers-vs-blocks"><span class="mr-2">Blockers vs Blocks</span><a href="#blockers-vs-blocks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are several key concepts you need to understand in order to benefit from the Interlace tool.</p><p><strong>Blockers</strong></p><p>A blocker prevents execution of commands following until all commands proceeding it has been completed. We can declare a blocker as follows</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>_blocker_
</pre></table></code></div></div><p><strong>Blocks</strong></p><p>Blocks can be used to run commands that you would like to run in sequence, for example creating a folder before attempting to store the input in it. Interlace tries hard to run as much in parallel as possible and keep your system resources fully balanced however some things just need to be run in a strict order!</p><p>We can declare a block as follows</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>_block:something_
<span class="nb">mkdir </span>_output_
nmap _target_ <span class="nt">-oA</span> _output_/nmap-default
_block:something_
</pre></table></code></div></div><p><strong>Command Queue is Intelligent</strong></p><p>This is important! One of the key uses of Interlace is that you use it to run commands from a file. The commands are looped over for each of the targets and items you might want to provide as command-line flags or positional values are passed available to each command in the form of strings that are replaced on each iteration <code class="language-shell highlighter-rouge">_target_</code>, <code class="language-shell highlighter-rouge">_port_</code> and <code class="language-shell highlighter-rouge">_output_</code> for a few examples. See below for the full table.</p><p>If however you put a line down that does not include any variables that need swapping out then Interlace will only run that command once.</p><p>Without going into the technical aspects of running commands at the moment, if we ran the following two commands as part of a command file against a 10.10.10.0/29 Cidr range then we would only get one DNS packet sent to Google and eight sent to the 10.10.10.0/29</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>ping <span class="nt">-c</span> 1 8.8.8.8
ping <span class="nt">-c</span> 1 _target_
</pre></table></code></div></div><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/e308540e-2b88-47a4-9a28-9dcfd2d65cce.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark"></figcaption><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"><img data-src="/174d2199-c153-4b0a-ab21-15d6bf4b8a69.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark"></figcaption></figure></figure><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/77696a18-7c23-494e-8c2c-525eef93dbfa.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark"></figcaption></figure><p>This is ideal as we wouldn‚Äôt want to ping google DNS every time we ping a new host.</p><h2 id="running-commands"><span class="mr-2">Running Commands</span><a href="#running-commands" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We have two main ways of running commands. Either from a file or directly from the command line.</p><h3 id="from-the-command-line"><span class="mr-2">From The Command Line</span><a href="#from-the-command-line" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/93d185a7-f903-4b7e-a793-0a6bffae3cd4.png" class="figure-img img-fluid border border-1 border-dark" alt="Running Commands Direct From Terminal." data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark">Running Commands Direct From Terminal.</figcaption></figure><p>Just to reinforce last point! When I do not use a replaceable target string the command runs just once.</p><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/7cabc5e0-e016-48d5-9f94-759c7f63aa35.png" class="figure-img img-fluid border border-1 border-dark" alt="Command Runs Once Without Replaceable String." data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark">Command Runs Once Without Replaceable String</figcaption></figure><p>Lastly, note if I give the command two ports but no <code class="language-shell highlighter-rouge">_target_</code> then it will run once for each port.</p><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/93e7008a-650f-4406-997d-e0446cfb3d6e.png" class="figure-img img-fluid border border-1 border-dark" alt="Adding Extra Ports Increases Command Variations." data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark">Adding Extra Ports Increases Command Variations.</figcaption></figure><h3 id="from-a-file"><span class="mr-2">From a File</span><a href="#from-a-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When we create our scans from files we have more control and access to a few more features.</p><p>Let us have a quick look at some of the variable replacement we have access to.</p><div class="table-wrapper"><table><thead><tr><th>Variable<th>Replacement<tbody><tr><td>_target_<td>Replaced with the expanded target list that the current thread is running against<tr><td>_cleantarget_<td>Replaced with target cleanded from http:// or https://<tr><td>_host_<td>Works the same as _target_, and can be used interchangeably<tr><td>_output_<td>Replaced with the output folder variable from Interlace<tr><td>_port_<td>Replaced with the expanded port variable from Interlace<tr><td>_realport_<td>Replaced with the real port variable from Interlace<tr><td>_proxy_<td>Replaced with the proxy list from Interlace<tr><td>_random_<td>Replaced with the randomly chosen file from Interlace</table></div><p>As we pass options to Interlace they become available to us in our scans.</p><p>For example, if we start a scan off like this</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>interlace <span class="nt">-t</span> 10.10.10.0/24 <span class="nt">-p</span> 80 <span class="nt">-o</span> ./bug_bounty <span class="nt">-cL</span> commands.il
</pre></table></code></div></div><p>We would have access to <code class="language-shell highlighter-rouge">_target_</code>, <code class="language-shell highlighter-rouge">_port_</code> and <code class="language-shell highlighter-rouge">_output_</code> variables within our Interlace command files (<code class="language-shell highlighter-rouge"><span class="nt">-cL</span></code> is for providing Interlace with a list of commands). We might make a file such as</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>_block:nikto_
<span class="nb">mkdir</span> <span class="nt">-p</span> _output_/_target_/nikto/
nikto <span class="nt">-host</span> _target_ <span class="nt">-port</span> _port_ <span class="nt">-output</span> _output_/nikto/nikto-_target_-_port_.htm
_block:nikto_
</pre></table></code></div></div><p>We put the commands in a block to ensure they run sequentially in their thread. We do not want Nikto trying to save to an output directory that does not exist.</p><p>While Interlace can look impressive at first we can avoid some of the screen clutter by adding the following options <code class="language-shell highlighter-rouge"><span class="nt">--no-bar</span></code> and <code class="language-shell highlighter-rouge"><span class="nt">--silent</span></code>.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>interlace <span class="nt">-t</span> 10.10.10.0/24 <span class="nt">-p</span> 80 <span class="nt">-o</span> ./bug_bounty <span class="nt">-cL</span> commands.il <span class="nt">--no-bar</span> <span class="nt">--silent</span>
</pre></table></code></div></div><p>Epanding our example even further!</p><p>Open up burpsuite and echo the default proxy address into a proxy.txt file.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>burpsuite
<span class="nb">echo </span>http://127.0.0.1:8080 <span class="o">&gt;</span> proxy.txt
</pre></table></code></div></div><p>Add the proxy option to Nikto</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>_block:nikto_
<span class="nb">mkdir</span> <span class="nt">-p</span> _output_/_target_/nikto/
nikto <span class="nt">-host</span> _target_ <span class="nt">-port</span> _port_ <span class="nt">-output</span> _output_/nikto/nikto-_target_-_port_.htm <span class="nt">-useproxy</span> _proxy_
_block:nikto_
</pre></table></code></div></div><p>Now as we scan our scans are caught by burpsuite.</p><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/08747b40-624a-4bfd-a67d-9935fe11e6c0.png" class="figure-img img-fluid border border-1 border-dark" alt="Targets Being Proxied Via Burp." data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark">Targets Being Proxied Via Burp.</figcaption></figure><blockquote><p>One item we have not looked at yet is the <code class="language-shell highlighter-rouge"><span class="nt">-threads</span></code> option. By default it is set to 10 but you can set it to what you want based on the performance of your machine.</p></blockquote><h2 id="making-a-ctf-fuzzer"><span class="mr-2">Making a CTF Fuzzer</span><a href="#making-a-ctf-fuzzer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h5 class="step"> Step one, Helper Function</h5><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>






Let us create a file as follows <span class="o">(</span>There is a convention of calling interlace configurations as dot <span class="sb">`</span>il<span class="sb">`</span><span class="o">)</span>
</pre></table></code></div></div><p>nano test.il</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
Inside the <span class="sb">`</span>test.il<span class="sb">`</span> file we will write the following
</pre></table></code></div></div><p>mkdir output &amp;&amp; echo ‚Äúmade‚Äù ping -c 2 <em>target</em></p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
Now we will run this on the <span class="nb">command </span>line 
</pre></table></code></div></div><p>interlace -t 10.10.10.0/29 -cL test.il ‚Äìno-bar -threads 15 ‚Äìsilent</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>




<span class="nb">mkdir </span>_target_ <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">"Made Directory For _target"</span>
_blocker_
_block:ping_
ping <span class="nt">-c</span> 2 _target_
_block:ping_
_block:curl




</pre></table></code></div></div><p>nano staged_nmap.il</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Inside we will put the following
</pre></table></code></div></div><p>rm -rf <em>output</em> mkdir -p <em>output</em>/<em>target</em>/scans/ mkdir -p <em>output</em>/<em>target</em>/scans/nmap mkdir -p <em>output</em>/<em>target</em>/scans/nmblookup mkdir -p <em>output</em>/<em>target</em>/scans/cme mkdir -p <em>output</em>/<em>target</em>/loot/ mkdir -p <em>output</em>/<em>target</em>/downloads/ mkdir -p <em>output</em>/<em>target</em>/shells/ <em>blocker</em> nmap -sSV -vv ‚Äìscript banner -A ‚Äìtop-ports=20 <em>target</em> -oA <em>output</em>/<em>target</em>/scans/nmap/nmap-_target_-quick-scan <em>blocker</em> nmap -T4 -sSV -vv -p- ‚Äìmax-retries=2 <em>target</em> -oA <em>output</em>/<em>target</em>/scans/nmap/nmap-_target_-full-65k-syn nmap -T4 -sUV -vv ‚Äìtop-ports=2000 ‚Äìmax-retries=1 <em>target</em> -oA <em>output</em>/<em>target</em>/scans/nmap/nmap-_target_-top-2000-udp <em>blocker</em> nmblookup -A <em>target</em> &gt; <em>output</em>/<em>target</em>/scans/nmblookup/nmblookup-_target_.txt crackmapexec smb <em>target</em> &gt; <em>output</em>/<em>target</em>/scans/crackmapexec/cme-_target_.txt</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
We can now run our first <span class="nb">command </span>like so. 
</pre></table></code></div></div><p>interlace -tL ./targets.txt -threads 10 -cL staged_nmap.il -o /pentest/output ```</p><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/eaa5ddee-a211-4930-bede-cee45ad9c816.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark"></figcaption></figure><figure class="figure text-center col-xs-12 col-sm-12 col-lg-12"> <img data-src="//static/5a89ffdd-d554-4feb-a9b7-c96fdc25cfb0.png" class="figure-img img-fluid border border-1 border-dark" alt=" " data-proofer-ignore><figcaption class="figure-caption text-center fw-normal text-dark"></figcaption></figure><p>Variable Replacement <em>target</em> Replaced with the expanded target list that the current thread is running against <em>cleantarget</em> Replaced with target cleanded from http:// or https:// <em>host</em> Works the same as <em>target</em>, and can be used interchangeably <em>output</em> Replaced with the output folder variable from Interlace <em>port</em> Replaced with the expanded port variable from Interlace <em>realport</em> Replaced with the real port variable from Interlace <em>proxy</em> Replaced with the proxy list from Interlace <em>random</em> Replaced with the randomly chosen file from Interlace</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='//categories/tutorial/'>tutorial</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="//tags/automation/" class="post-tag no-text-decoration" >automation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automation+For+Pentesters+Series+-++Part+1+Interlace+-+EvilSaint&url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fautomation-pentesters-series-part-1-interlace%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automation+For+Pentesters+Series+-++Part+1+Interlace+-+EvilSaint&u=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fautomation-pentesters-series-part-1-interlace%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fautomation-pentesters-series-part-1-interlace%2F&text=Automation+For+Pentesters+Series+-++Part+1+Interlace+-+EvilSaint" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=http%3A%2F%2Ftheevilsaint.github.io%2Fposts%2Fautomation-pentesters-series-part-1-interlace%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/windows-registry/">Windows Registry</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/automating-vultr-setup-vultr-api-v1/"><div class="card-body"> <em class="small" data-ts="1587337200" data-df="ll" > Apr 20, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Automating Vultr Setup with Vultr API V1</h3><div class="text-muted small"><p> API Endpoint: https://api.vultr.com/ API Key: Available in Members Area Example curl -H &quot;API-Key: YOURKEY&quot; https://api.vultr.com/v1/server/create --data &quot;DCID=8&quot; --data &quot;VPSPLANID=201&quot; --data &quot;O...</p></div></div></a></div><div class="card"> <a href="/posts/rename-vmdk-disk-and-associated-files-vmware-virtual-disk-manager/"><div class="card-body"> <em class="small" data-ts="1618441200" data-df="ll" > Apr 15, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Rename a VMDK disk and associated files with VMware Virtual Disk Manager</h3><div class="text-muted small"><p> I have a template Kali Linux Virtual Machine that I keep around in case in case of an unfixable error on my current engagement machine. The filenames inside this folder are quite verbose and are in...</p></div></div></a></div><div class="card"> <a href="/posts/using-screen-for-linux/"><div class="card-body"> <em class="small" data-ts="1618786800" data-df="ll" > Apr 19, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Moving Around The Terminal Like A Boss: Using Screen For Linux</h3><div class="text-muted small"><p> Installing Setting Name screen -S &amp;lt;my scans&amp;gt;</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="//posts/getting-started-i3wm/" class="btn btn-outline-primary" prompt="Older"><p>Getting Started With i3wm</p></a> <a href="//posts/credential-dumping/" class="btn btn-outline-primary" prompt="Newer"><p>Credential Dumping</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "TheEvilSaint/theevilsaint.github.io", "data-repo-id": "MDEwOlJlcG9zaXRvcnkyNTQ3ODQ3Nzk", "data-category": "Comments", "data-category-id": "DIC_kwDODy-1C84CSN7z", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ssl/">ssl</a> <a class="post-tag" href="/tags/tls/">tls</a> <a class="post-tag" href="/tags/powershell/">powershell</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/enumeration/">enumeration</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/git/">git</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> ¬© 2023 <a href="https://www.twitter.com/_evilsaint_/">evilsaint</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available!</p><button type="button" class="btn btn-primary" aria-label="Update"> Update üöÄ </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-KK5XXRT4LD"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KK5XXRT4LD'); }); </script>
